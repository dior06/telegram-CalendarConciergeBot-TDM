# Архитектура и структура проекта

## Архитектура проекта

Проект построен по модульной архитектуре, где каждый компонент отвечает за отдельный функциональный блок:

1. **Бот-обработчик сообщений**: основная логика взаимодействия с пользователем реализована в модуле `bot.py`. Здесь обрабатываются команды пользователей, вызываются функции создания и изменения встреч.
2. **Сервис управления встречами**: отдельный модуль, отвечающий за операции с встречами, такие как создание, изменение, проверка доступности, уведомление участников и запись статистики.
3. **Модуль работы с базой данных**: взаимодействует с базой данных для хранения данных о встречах, участниках и статистике.
4. **Интеграция с внешними API** (например, Google Календарь): выполняет подключение и синхронизацию данных о встречах с календарем пользователя, позволяя автоматизировать добавление встреч.
5. **Обработка уведомлений и статистики**: модуль, ответственный за периодическую отправку уведомлений о встречах и сбор данных для отображения статистики загруженности участников.

## Структура базы данных

Используемая база данных может быть SQLite или PostgreSQL. Основные таблицы:

1. **users**: информация о пользователях (ID, username, имя, время создания).
2. **meetings**: данные о встречах (ID, название, описание, время начала и окончания, участники, статус).
3. **meeting_participants**: связь между встречами и участниками.
4. **statistics**: хранилище для статистики, например, количество встреч за последние 7 дней, загруженность по участникам.

Примерная структура таблиц:
```sql
CREATE TABLE users (
    user_id SERIAL PRIMARY KEY,
    username VARCHAR(255),
    first_name VARCHAR(255),
    last_name VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE meetings (
    meeting_id SERIAL PRIMARY KEY,
    title VARCHAR(255),
    description TEXT,
    start_time TIMESTAMP,
    end_time TIMESTAMP,
    status VARCHAR(50) DEFAULT 'scheduled'
);

CREATE TABLE meeting_participants (
    meeting_id INT REFERENCES meetings(meeting_id),
    user_id INT REFERENCES users(user_id),
    PRIMARY KEY (meeting_id, user_id)
);

CREATE TABLE statistics (
    stat_id SERIAL PRIMARY KEY,
    user_id INT REFERENCES users(user_id),
    week_start_date DATE,
    meeting_count INT
);
```

## Взаимодействие между компонентами

1. **Пользователь** взаимодействует с ботом через команды, такие как `/create_meeting`, `/edit_meeting` и т.д.
2. **Бот** обрабатывает команды, запрашивает или проверяет данные пользователя и вызывает нужные функции из других модулей.
3. **Модуль данных о встречах** взаимодействует с базой для добавления или изменения информации о встречах и отправляет уведомления через бота.
4. **Модуль статистики** собирает данные по загруженности и генерирует отчеты, которые можно запрашивать через бота.
5. **Интеграция с Google Календарем** позволяет автоматически синхронизировать данные о встречах.

## Диаграмма структуры проекта

```
┌──────────────┐        ┌───────────────┐
│ User         │───────▶│ Telegram Bot  │
└──────────────┘        └───────────────┘
                            │
                            │
                   ┌────────▼────────┐
                   │ Meeting Service │
                   └────────┬────────┘
                            │
            ┌───────────────┴───────────────┐
            │                               │
   ┌────────▼─────────┐             ┌───────▼──────────┐
   │ Database         │             │ Google Calendar   │
   └──────────────────┘             └───────────────────┘
```
